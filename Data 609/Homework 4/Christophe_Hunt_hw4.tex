\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={Homework 4},
            pdfauthor={Christophe Hunt},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{{#1}}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{{#1}}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\ImportTok}[1]{{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{{#1}}}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{{#1}}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{{#1}}}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{{#1}}}}
\newcommand{\BuiltInTok}[1]{{#1}}
\newcommand{\ExtensionTok}[1]{{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{{#1}}}
\newcommand{\RegionMarkerTok}[1]{{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{{#1}}}}
\newcommand{\NormalTok}[1]{{#1}}
\usepackage{longtable,booktabs}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\newcommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}
  \title{Homework 4}
  \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
  \author{Christophe Hunt}
  \preauthor{\centering\large\emph}
  \postauthor{\par}
  \predate{\centering\large\emph}
  \postdate{\par}
  \date{February 20, 2017}

\usepackage{relsize}
\usepackage{setspace}
\usepackage{amsmath,amsfonts,amsthm}
\usepackage[sfdefault]{roboto}
\usepackage[T1]{fontenc}
\usepackage{float}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{2}
\tableofcontents
}
\newpage

\section{Page 191: problem 3}\label{page-191-problem-3}

Using Monte Carlo Simulation, write an algorithm to calculate an
approximation to \(\pi\) by considering the number of random points
selected inside the quarter circle
\[Q:x^2 +y^2 = 1, x \geq 0, y \geq 0\] where the quarter circle is taken
to be inside the square \[S : 0 \leq x \leq 1~and~0 \leq y \leq 1\] Use
the equation \(\frac{\pi}{4}=area\); \(\frac{Q}{area}S\).

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{1234}\NormalTok{)}

\NormalTok{monte_carlo <-}\StringTok{ }\NormalTok{function(n)\{}
  \NormalTok{counter =}\StringTok{ }\DecValTok{0}
  \NormalTok{for (i in }\DecValTok{1}\NormalTok{:n)\{}
    \NormalTok{y <-}\StringTok{ }\KeywordTok{runif}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}
    \NormalTok{x <-}\StringTok{ }\KeywordTok{runif}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}
    \NormalTok{if ((x^}\DecValTok{2} \NormalTok{+}\StringTok{ }\NormalTok{y^}\DecValTok{2}\NormalTok{) <}\StringTok{ }\DecValTok{1}\NormalTok{)\{}
      \NormalTok{counter <-}\StringTok{ }\NormalTok{counter +}\StringTok{ }\DecValTok{1} 
    \NormalTok{\} else \{}
      \NormalTok{counter <-}\StringTok{ }\NormalTok{counter}
    \NormalTok{\}}
  \NormalTok{\}}
  \KeywordTok{return}\NormalTok{(counter)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n <-}\StringTok{ }\DecValTok{500}
\NormalTok{(}\KeywordTok{monte_carlo}\NormalTok{(n)/n)*}\DecValTok{4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3.104
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n <-}\StringTok{ }\DecValTok{50000}
\NormalTok{(}\KeywordTok{monte_carlo}\NormalTok{(n)/n)*}\DecValTok{4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3.14312
\end{verbatim}

\newpage

\section{Page 194: problem 1}\label{page-194-problem-1}

Use the middle-square method to generate.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{middle_square <-}\StringTok{ }\NormalTok{function(n, seed) \{}
          \KeywordTok{suppressMessages}\NormalTok{(}\KeywordTok{require}\NormalTok{(stringr))}
          \NormalTok{results <-}\StringTok{ }\KeywordTok{list}\NormalTok{(}\StringTok{"instances"} \NormalTok{=}\StringTok{ }\NormalTok{n, }\StringTok{"starting_seed"} \NormalTok{=}\StringTok{ }\NormalTok{seed)}
          \NormalTok{for (i in }\DecValTok{1}\NormalTok{:n)\{}
            \NormalTok{j <-}\StringTok{ }\NormalTok{(seed^}\DecValTok{2}\NormalTok{)}
              \NormalTok{if (}\KeywordTok{nchar}\NormalTok{(j) <}\StringTok{ }\DecValTok{8}\NormalTok{)\{}
                  \NormalTok{j <-}\StringTok{ }\KeywordTok{str_pad}\NormalTok{(j, }\DecValTok{8}\NormalTok{, }\DataTypeTok{pad =} \StringTok{"0"}\NormalTok{)}
              \NormalTok{\} else if (}\KeywordTok{nchar}\NormalTok{(j) >}\StringTok{ }\DecValTok{8}\NormalTok{) \{}
                \NormalTok{j <-}\StringTok{ }\KeywordTok{substr}\NormalTok{(j, }\DecValTok{1}\NormalTok{, }\DecValTok{8}\NormalTok{)}
              \NormalTok{\}}
            \NormalTok{t <-}\StringTok{ }\NormalTok{j }
            \NormalTok{j <-}\StringTok{ }\KeywordTok{substr}\NormalTok{(j, }\DecValTok{3}\NormalTok{, }\DecValTok{6}\NormalTok{)}
            \NormalTok{seed <-}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(j)}
            \NormalTok{results[[}\KeywordTok{length}\NormalTok{(results)+}\DecValTok{1}\NormalTok{]] <-}\StringTok{ }\KeywordTok{list}\NormalTok{(}\StringTok{"number"} \NormalTok{=}\StringTok{ }\NormalTok{t, }\StringTok{"new_seed"} \NormalTok{=}\StringTok{ }\NormalTok{seed)}
          \NormalTok{\}}
         \KeywordTok{return}\NormalTok{(results)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\subsection{\texorpdfstring{a. 10 random numbers using
\(x_0 = 1009\)}{a. 10 random numbers using x\_0 = 1009}}\label{a.-10-random-numbers-using-x_0-1009}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{middle_square}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{1009}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $instances
## [1] 10
## 
## $starting_seed
## [1] 1009
## 
## [[3]]
## [[3]]$number
## [1] "01018081"
## 
## [[3]]$new_seed
## [1] 180
## 
## 
## [[4]]
## [[4]]$number
## [1] "00032400"
## 
## [[4]]$new_seed
## [1] 324
## 
## 
## [[5]]
## [[5]]$number
## [1] "00104976"
## 
## [[5]]$new_seed
## [1] 1049
## 
## 
## [[6]]
## [[6]]$number
## [1] "01100401"
## 
## [[6]]$new_seed
## [1] 1004
## 
## 
## [[7]]
## [[7]]$number
## [1] "01008016"
## 
## [[7]]$new_seed
## [1] 80
## 
## 
## [[8]]
## [[8]]$number
## [1] "00006400"
## 
## [[8]]$new_seed
## [1] 64
## 
## 
## [[9]]
## [[9]]$number
## [1] "00004096"
## 
## [[9]]$new_seed
## [1] 40
## 
## 
## [[10]]
## [[10]]$number
## [1] "00001600"
## 
## [[10]]$new_seed
## [1] 16
## 
## 
## [[11]]
## [[11]]$number
## [1] "00000256"
## 
## [[11]]$new_seed
## [1] 2
## 
## 
## [[12]]
## [[12]]$number
## [1] "00000004"
## 
## [[12]]$new_seed
## [1] 0
\end{verbatim}

\subsection{\texorpdfstring{b. 20 random numbers using
\(x_0 = 653217\)}{b. 20 random numbers using x\_0 = 653217}}\label{b.-20-random-numbers-using-x_0-653217}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{middle_square}\NormalTok{(}\DecValTok{20}\NormalTok{, }\DecValTok{653217}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\$instances {[}1{]} 20

\$starting\_seed {[}1{]} 653217

{[}{[}3{]}{]}{[}{[}3{]}{]}\$number {[}1{]} ``42669244''

{[}{[}3{]}{]}\$new\_seed {[}1{]} 6692

{[}{[}4{]}{]}{[}{[}4{]}{]}\$number {[}1{]} 44782864

{[}{[}4{]}{]}\$new\_seed {[}1{]} 7828

{[}{[}5{]}{]}{[}{[}5{]}{]}\$number {[}1{]} 61277584

{[}{[}5{]}{]}\$new\_seed {[}1{]} 2775

{[}{[}6{]}{]}{[}{[}6{]}{]}\$number {[}1{]} ``07700625''

{[}{[}6{]}{]}\$new\_seed {[}1{]} 7006

{[}{[}7{]}{]}{[}{[}7{]}{]}\$number {[}1{]} 49084036

{[}{[}7{]}{]}\$new\_seed {[}1{]} 840

{[}{[}8{]}{]}{[}{[}8{]}{]}\$number {[}1{]} ``00705600''

{[}{[}8{]}{]}\$new\_seed {[}1{]} 7056

{[}{[}9{]}{]}{[}{[}9{]}{]}\$number {[}1{]} 49787136

{[}{[}9{]}{]}\$new\_seed {[}1{]} 7871

{[}{[}10{]}{]}{[}{[}10{]}{]}\$number {[}1{]} 61952641

{[}{[}10{]}{]}\$new\_seed {[}1{]} 9526

{[}{[}11{]}{]}{[}{[}11{]}{]}\$number {[}1{]} 90744676

{[}{[}11{]}{]}\$new\_seed {[}1{]} 7446

{[}{[}12{]}{]}{[}{[}12{]}{]}\$number {[}1{]} 55442916

{[}{[}12{]}{]}\$new\_seed {[}1{]} 4429

{[}{[}13{]}{]}{[}{[}13{]}{]}\$number {[}1{]} 19616041

{[}{[}13{]}{]}\$new\_seed {[}1{]} 6160

{[}{[}14{]}{]}{[}{[}14{]}{]}\$number {[}1{]} 37945600

{[}{[}14{]}{]}\$new\_seed {[}1{]} 9456

{[}{[}15{]}{]}{[}{[}15{]}{]}\$number {[}1{]} 89415936

{[}{[}15{]}{]}\$new\_seed {[}1{]} 4159

{[}{[}16{]}{]}{[}{[}16{]}{]}\$number {[}1{]} 17297281

{[}{[}16{]}{]}\$new\_seed {[}1{]} 2972

{[}{[}17{]}{]}{[}{[}17{]}{]}\$number {[}1{]} ``08832784''

{[}{[}17{]}{]}\$new\_seed {[}1{]} 8327

{[}{[}18{]}{]}{[}{[}18{]}{]}\$number {[}1{]} 69338929

{[}{[}18{]}{]}\$new\_seed {[}1{]} 3389

{[}{[}19{]}{]}{[}{[}19{]}{]}\$number {[}1{]} 11485321

{[}{[}19{]}{]}\$new\_seed {[}1{]} 4853

{[}{[}20{]}{]}{[}{[}20{]}{]}\$number {[}1{]} 23551609

{[}{[}20{]}{]}\$new\_seed {[}1{]} 5516

{[}{[}21{]}{]}{[}{[}21{]}{]}\$number {[}1{]} 30426256

{[}{[}21{]}{]}\$new\_seed {[}1{]} 4262

{[}{[}22{]}{]}{[}{[}22{]}{]}\$number {[}1{]} 18164644

{[}{[}22{]}{]}\$new\_seed {[}1{]} 1646

\subsection{\texorpdfstring{c. 15 random numbers using
\(x_0 = 3043\)}{c. 15 random numbers using x\_0 = 3043}}\label{c.-15-random-numbers-using-x_0-3043}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{middle_square}\NormalTok{(}\DecValTok{15}\NormalTok{, }\DecValTok{3043}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\$instances {[}1{]} 15

\$starting\_seed {[}1{]} 3043

{[}{[}3{]}{]}{[}{[}3{]}{]}\$number {[}1{]} ``09259849''

{[}{[}3{]}{]}\$new\_seed {[}1{]} 2598

{[}{[}4{]}{]}{[}{[}4{]}{]}\$number {[}1{]} ``06749604''

{[}{[}4{]}{]}\$new\_seed {[}1{]} 7496

{[}{[}5{]}{]}{[}{[}5{]}{]}\$number {[}1{]} 56190016

{[}{[}5{]}{]}\$new\_seed {[}1{]} 1900

{[}{[}6{]}{]}{[}{[}6{]}{]}\$number {[}1{]} ``03610000''

{[}{[}6{]}{]}\$new\_seed {[}1{]} 6100

{[}{[}7{]}{]}{[}{[}7{]}{]}\$number {[}1{]} 37210000

{[}{[}7{]}{]}\$new\_seed {[}1{]} 2100

{[}{[}8{]}{]}{[}{[}8{]}{]}\$number {[}1{]} ``04410000''

{[}{[}8{]}{]}\$new\_seed {[}1{]} 4100

{[}{[}9{]}{]}{[}{[}9{]}{]}\$number {[}1{]} 16810000

{[}{[}9{]}{]}\$new\_seed {[}1{]} 8100

{[}{[}10{]}{]}{[}{[}10{]}{]}\$number {[}1{]} 65610000

{[}{[}10{]}{]}\$new\_seed {[}1{]} 6100

{[}{[}11{]}{]}{[}{[}11{]}{]}\$number {[}1{]} 37210000

{[}{[}11{]}{]}\$new\_seed {[}1{]} 2100

{[}{[}12{]}{]}{[}{[}12{]}{]}\$number {[}1{]} ``04410000''

{[}{[}12{]}{]}\$new\_seed {[}1{]} 4100

{[}{[}13{]}{]}{[}{[}13{]}{]}\$number {[}1{]} 16810000

{[}{[}13{]}{]}\$new\_seed {[}1{]} 8100

{[}{[}14{]}{]}{[}{[}14{]}{]}\$number {[}1{]} 65610000

{[}{[}14{]}{]}\$new\_seed {[}1{]} 6100

{[}{[}15{]}{]}{[}{[}15{]}{]}\$number {[}1{]} 37210000

{[}{[}15{]}{]}\$new\_seed {[}1{]} 2100

{[}{[}16{]}{]}{[}{[}16{]}{]}\$number {[}1{]} ``04410000''

{[}{[}16{]}{]}\$new\_seed {[}1{]} 4100

{[}{[}17{]}{]}{[}{[}17{]}{]}\$number {[}1{]} 16810000

{[}{[}17{]}{]}\$new\_seed {[}1{]} 8100 \#\# TODO c. Comment about the
results of each sequence. Was there cycling? Did each sequence
degenerate rapidly?

\section{Page 199: problem 4}\label{page-199-problem-4}

Given loaded dice according to the following distribution, use Monte
Carlo simulation to simulate the sum of 300 rolls of two unfair dice.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(knitr)}
\NormalTok{Roll <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{:}\DecValTok{6}\NormalTok{)}
\NormalTok{Die_1 <-}\StringTok{ }\KeywordTok{c}\NormalTok{(.}\DecValTok{1}\NormalTok{,.}\DecValTok{1}\NormalTok{,.}\DecValTok{2}\NormalTok{,.}\DecValTok{3}\NormalTok{,.}\DecValTok{2}\NormalTok{,.}\DecValTok{1}\NormalTok{)}
\NormalTok{Die_2 <-}\StringTok{ }\KeywordTok{c}\NormalTok{(.}\DecValTok{3}\NormalTok{,.}\DecValTok{1}\NormalTok{,.}\DecValTok{2}\NormalTok{,.}\DecValTok{1}\NormalTok{,.}\DecValTok{05}\NormalTok{,.}\DecValTok{25}\NormalTok{)}
\KeywordTok{kable}\NormalTok{(}\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(Roll, Die_1, Die_2)))}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}rrr@{}}
\toprule
Roll & Die\_1 & Die\_2\tabularnewline
\midrule
\endhead
1 & 0.1 & 0.30\tabularnewline
2 & 0.1 & 0.10\tabularnewline
3 & 0.2 & 0.20\tabularnewline
4 & 0.3 & 0.10\tabularnewline
5 & 0.2 & 0.05\tabularnewline
6 & 0.1 & 0.25\tabularnewline
\bottomrule
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{unfair_roll <-}\StringTok{ }\NormalTok{function(n, probs)\{}
    \NormalTok{if (}\KeywordTok{length}\NormalTok{(probs) !=}\StringTok{ }\DecValTok{6}\NormalTok{)\{}
      \KeywordTok{print}\NormalTok{(}\StringTok{"missing probabilities for all 6 sides"}\NormalTok{)}
      \NormalTok{break}
    \NormalTok{\}}
    \NormalTok{results <-}\StringTok{ }\KeywordTok{list}\NormalTok{(}\StringTok{"1"} \NormalTok{=}\StringTok{ }\DecValTok{0}\NormalTok{, }\StringTok{"2"} \NormalTok{=}\StringTok{ }\DecValTok{0} \NormalTok{, }\StringTok{"3"} \NormalTok{=}\StringTok{ }\DecValTok{0}\NormalTok{, }\StringTok{"4"} \NormalTok{=}\StringTok{ }\DecValTok{0}\NormalTok{, }\StringTok{"5"} \NormalTok{=}\StringTok{ }\DecValTok{0}\NormalTok{, }\StringTok{"6"} \NormalTok{=}\StringTok{ }\DecValTok{0}\NormalTok{)}
         \NormalTok{for (i in }\DecValTok{1}\NormalTok{:n)\{}
       \NormalTok{j <-}\StringTok{ }\DecValTok{1} 
       \NormalTok{x <-}\StringTok{ }\KeywordTok{runif}\NormalTok{(j, }\DecValTok{0}\NormalTok{, j)}
       \NormalTok{if (x ==}\StringTok{ }\DecValTok{0}\NormalTok{)\{}
        \NormalTok{results[[j]] <-}\StringTok{ }\NormalTok{results[[j]] +}\StringTok{ }\DecValTok{1}
       \NormalTok{\} else if (x >}\StringTok{ }\DecValTok{0} \NormalTok{&}\StringTok{ }\NormalTok{x <=}\StringTok{ }\NormalTok{probs[[j]])\{}
        \NormalTok{results[[j]] <-}\StringTok{ }\NormalTok{results[[j]] +}\StringTok{ }\DecValTok{1}
        \NormalTok{next}
       \NormalTok{\} else \{}
       \NormalTok{j <-}\StringTok{ }\NormalTok{j +}\StringTok{ }\DecValTok{1}
       \NormalTok{while ((x >}\StringTok{ }\KeywordTok{sum}\NormalTok{(probs[}\DecValTok{0}\NormalTok{:(j}\DecValTok{-1}\NormalTok{)]) &}\StringTok{ }\NormalTok{x <=}\StringTok{ }\KeywordTok{sum}\NormalTok{(probs[}\DecValTok{0}\NormalTok{:j])) !=}\StringTok{ }\OtherTok{TRUE}\NormalTok{) \{}
       \NormalTok{j <-}\StringTok{ }\NormalTok{j +}\StringTok{ }\DecValTok{1}
       \NormalTok{\}}
       \NormalTok{results[[j]] <-}\StringTok{ }\NormalTok{results[[j]] +}\StringTok{ }\DecValTok{1}
       \NormalTok{\}}
     \NormalTok{\}}
    \NormalTok{for (i in }\DecValTok{1}\NormalTok{:}\DecValTok{6}\NormalTok{)\{}
     \KeywordTok{names}\NormalTok{(results[[i]]) <-}\StringTok{ "occurences"}
     \NormalTok{results[[i]][[}\StringTok{"probability"}\NormalTok{]] <-}\StringTok{ }\KeywordTok{round}\NormalTok{(results[[i]]/n,}\DecValTok{2}\NormalTok{)}
    \NormalTok{\}}
  \KeywordTok{return}\NormalTok{(results)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{unfair_roll}\NormalTok{(}\DecValTok{300}\NormalTok{, Die_1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $`1`
##  occurences probability 
##       27.00        0.09 
## 
## $`2`
##  occurences probability 
##       34.00        0.11 
## 
## $`3`
##  occurences probability 
##       56.00        0.19 
## 
## $`4`
##  occurences probability 
##        90.0         0.3 
## 
## $`5`
##  occurences probability 
##        59.0         0.2 
## 
## $`6`
##  occurences probability 
##       34.00        0.11
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{unfair_roll}\NormalTok{(}\DecValTok{300}\NormalTok{, Die_2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $`1`
##  occurences probability 
##       82.00        0.27 
## 
## $`2`
##  occurences probability 
##       24.00        0.08 
## 
## $`3`
##  occurences probability 
##       69.00        0.23 
## 
## $`4`
##  occurences probability 
##       27.00        0.09 
## 
## $`5`
##  occurences probability 
##       12.00        0.04 
## 
## $`6`
##  occurences probability 
##       86.00        0.29
\end{verbatim}

\section{Page 211: problem 3}\label{page-211-problem-3}

In many situations, the time \(T\) between deliveries and the order
quantity \(Q\) is not fixed. Instead, an order is placed for a specific
amount of gasoline. Depending on how many orders are placed in a given
time interval, the time to fill an order varies. You have no reason to
believe that the performance of the delivery operation will change.
Therefore, you hvae examined records for the past 100 deliveries and
found the following lag times, or extra days, required to fill your
order:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Lag_time <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{:}\DecValTok{7}\NormalTok{)}
\NormalTok{number_of_occurences <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{25}\NormalTok{, }\DecValTok{30}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{13}\NormalTok{, }\DecValTok{2}\NormalTok{)}
\NormalTok{X <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(Lag_time, number_of_occurences))}
\KeywordTok{kable}\NormalTok{(}\KeywordTok{rbind}\NormalTok{(X, }\KeywordTok{c}\NormalTok{(}\StringTok{" "}\NormalTok{, }\KeywordTok{sum}\NormalTok{(number_of_occurences))))}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}ll@{}}
\toprule
Lag\_time & number\_of\_occurences\tabularnewline
\midrule
\endhead
2 & 10\tabularnewline
3 & 25\tabularnewline
4 & 30\tabularnewline
5 & 20\tabularnewline
6 & 13\tabularnewline
7 & 2\tabularnewline
& 100\tabularnewline
\bottomrule
\end{longtable}

Construct a Monte Carlo simulation for the lag time submodel. If you
have a handheld calculator or computer avaialble, test your submodel by
running 1000 trials and comparing the number of occurances of the
various lag times with the historical data.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Lag_time <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{:}\DecValTok{7}\NormalTok{)}
\NormalTok{number_of_occurences <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{25}\NormalTok{, }\DecValTok{30}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{13}\NormalTok{, }\DecValTok{2}\NormalTok{)}

\NormalTok{lag_time <-}\StringTok{ }\NormalTok{function(n, probs, outcomes)\{}
        \NormalTok{results <-}\StringTok{ }\KeywordTok{list}\NormalTok{()}
        \NormalTok{for (i in }\DecValTok{1}\NormalTok{:}\KeywordTok{length}\NormalTok{(outcomes))\{}
         \NormalTok{results[[i]] <-}\StringTok{ }\DecValTok{0}
         \KeywordTok{names}\NormalTok{(results[[i]]) <-}\StringTok{ }\NormalTok{(}\KeywordTok{paste}\NormalTok{(}\StringTok{"# of deliveries on day"}\NormalTok{, outcomes[[i]]))}
        \NormalTok{\}}
     \NormalTok{for (i in }\DecValTok{1}\NormalTok{:n)\{}
       \NormalTok{j <-}\StringTok{ }\DecValTok{1} 
       \NormalTok{x <-}\StringTok{ }\KeywordTok{runif}\NormalTok{(j, }\DecValTok{0}\NormalTok{, j)}
       \NormalTok{if (x ==}\StringTok{ }\DecValTok{0}\NormalTok{)\{}
        \NormalTok{results[[j]] <-}\StringTok{ }\NormalTok{results[[j]] +}\StringTok{ }\DecValTok{1}
       \NormalTok{\} else if (x >}\StringTok{ }\DecValTok{0} \NormalTok{&}\StringTok{ }\NormalTok{x <=}\StringTok{ }\NormalTok{probs[[j]])\{}
        \NormalTok{results[[j]] <-}\StringTok{ }\NormalTok{results[[j]] +}\StringTok{ }\DecValTok{1}
        \NormalTok{next}
       \NormalTok{\} else \{}
       \NormalTok{j <-}\StringTok{ }\NormalTok{j +}\StringTok{ }\DecValTok{1}
       \NormalTok{while ((x >}\StringTok{ }\KeywordTok{sum}\NormalTok{(probs[}\DecValTok{0}\NormalTok{:(j}\DecValTok{-1}\NormalTok{)]) &}\StringTok{ }\NormalTok{x <=}\StringTok{ }\KeywordTok{sum}\NormalTok{(probs[}\DecValTok{0}\NormalTok{:j])) !=}\StringTok{ }\OtherTok{TRUE}\NormalTok{) \{}
       \NormalTok{j <-}\StringTok{ }\NormalTok{j +}\StringTok{ }\DecValTok{1}
       \NormalTok{\}}
       \NormalTok{results[[j]] <-}\StringTok{ }\NormalTok{results[[j]] +}\StringTok{ }\DecValTok{1}
       \NormalTok{\}}
     \NormalTok{\}}
    \NormalTok{for (i in }\DecValTok{1}\NormalTok{:}\KeywordTok{length}\NormalTok{(results))\{}
     \NormalTok{results[[i]][[}\StringTok{"probability"}\NormalTok{]] <-}\StringTok{ }\KeywordTok{round}\NormalTok{(results[[i]]/n,}\DecValTok{2}\NormalTok{)}
    \NormalTok{\}}
  \KeywordTok{return}\NormalTok{(results)}
\NormalTok{\}}
\NormalTok{probs <-}\StringTok{ }\NormalTok{(number_of_occurences/}\KeywordTok{sum}\NormalTok{(number_of_occurences))}
\KeywordTok{lag_time}\NormalTok{(}\DecValTok{1000}\NormalTok{, }\DataTypeTok{probs =} \NormalTok{probs , }\DataTypeTok{outcomes =} \NormalTok{Lag_time)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [[1]]
## # of deliveries on day 2              probability 
##                    102.0                      0.1 
## 
## [[2]]
## # of deliveries on day 3              probability 
##                   237.00                     0.24 
## 
## [[3]]
## # of deliveries on day 4              probability 
##                    299.0                      0.3 
## 
## [[4]]
## # of deliveries on day 5              probability 
##                   211.00                     0.21 
## 
## [[5]]
## # of deliveries on day 6              probability 
##                   125.00                     0.12 
## 
## [[6]]
## # of deliveries on day 7              probability 
##                    26.00                     0.03
\end{verbatim}


\end{document}
