---
title: "Project 1"
author: "Christophe"
date: "February 20, 2016"
output: html_document
---



```{r}
library(data.table)
library(Hmisc)
tinfo <- file("https://raw.githubusercontent.com/ChristopheHunt/MSDA---Coursework/master/Data%20607/Homework/data/tournamentinfo.txt", open="r" )
chess.data <- readLines(tinfo) # read lines 
chess.data <- data.frame(chess.data, do.call(rbind, strsplit(chess.data, split = "|", fixed = TRUE)))
chess.data <- data.frame(lapply(chess.data, as.character), stringsAsFactors=FALSE)
chess.data <- chess.data[!grepl(".+--.+", chess.data$X1),] # removes "------" lines
chess.data <- chess.data[,-c(1,12)]
## getting column names dynamically, ON HOLD
#column.names <- chess.data[2:3,]
#column_collapse <- function(x){for (i in names(x)) {x[i] <- paste(x[i], collapse = "") x}}

combine_rows <- function(dataframe){
                    df <- dataframe[0,]  ##create empty dataframe copy
                    for (i in colnames(dataframe)){  ## for all columns in data frame 
                        for (j in seq(1:length(dataframe[[i]]))){ ## for all rows in dataframe
                         df[j,i] <- gsub("\\s+"," ",(paste(dataframe[[i]][j:(j+1)], collapse = ""))) ## gsub removes extra space and then paste collapses two rows and replace previous data 
                        }
                    } 
                    return(df) # return the dataframe
                  }

chess.data <- (combine_rows(chess.data)) # run function on data frame
colnames(chess.data) <- chess.data[1,] # create column names from first row
chess.data <- chess.data[-(1:2),] # remove header information
index <- !is.na(as.numeric(gsub( " .*$", "",  str_trim(chess.data[,1])))) #gets the part of string, if a numeric value it converts to True
chess.data <- chess.data[index,]
chess.data$ID <- str_trim(str_extract(chess.data[,1], "\\s[[0-9]]{1,}"))
chess.data$State <- str_trim(str_extract(chess.data[,1], "\\s[^[0-9]].+"))
chess.data$Name <- str_extract(chess.data[,2], ".[^[0-9]]{1,}")
chess.data$Pre.score <- str_extract(str_extract(chess.data[,2], ":.[[0-9]]{1,}.[^[-]]"), "[[0-9]]{1,}")
chess.data$Post.score <- str_extract(str_extract(chess.data[,2], ">.[[0-9]]{1,}"), "[[0-9]]{1,}")

grepl(chess.data[,2], ":.[[0-9]]{1,}", perl = TRUE)


chess.data$ID <- gsub( " .*$", "",  str_trim(chess.data[,1]))
chess.data$State <- gsub( "$*. ", "",  str_trim(chess.data[,1]))
gsub("[:digit:]", "", chess.data$State)
test <- as.data.frame(gsub("\\s+"," ",chess.data))
sapply(strsplit(chess.data[,12], split = " "), "[", 2)

```


