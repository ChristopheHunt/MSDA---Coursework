---
title: "US Regions Views of Technology and Employement Characteristics"
output: html_notebook
---

```{r load data, include=FALSE}
library(pacman)
p_load(memisc, magrittr, knitr, htmlTable, Hmisc, pander, scales, tidyverse,RColorBrewer)
file <- file.path("C:", "Users", "Christophe", "Downloads" , "February-2014-Smithsonian-Science (1)", "February 2014 - Smithsonian Science", "Feb_2014_Views_Future_SPSS.sav")
survey.data <- spss.system.file(file) %>% as.data.set()
survey.data <- lapply(survey.data, function(x) gsub("\\()", "", gsub("(VOL.)", "", gsub("â..", "'", x)))) %>% as_tibble() ##to correct encoding artifacts
``` 

A national survey was conducted by Pew Research Center in conjunction with Smithsonian magazine between February 13-18, 2014 by landline and cell phones among 1,001 adults. The objective of the survey was to better understand US views towards scientific and technological changes and how they viewed the future. Understanding public perception of these types of changes occurring in the US is important to understand how Americans view their place in the changing environment and if they are hopeful or anxious about the future.   

The questions regarding scientific and technological changes were varied and include some issues currently being discussed today, such as "would you ride in a driver-less car?". In the below table we see that `r percent(514/1001)` of individuals in the survey were willing to ride in a driver-less car. 

```{r table of would you ride in a driverless car, echo = FALSE, results='asis'}
pander::pandoc.table(rev(table(survey.data$pial4b)), caption = "Pew Research Question : would you ride in a driver-less car?")
```
<br>

However, if we look at a map of a recent analysis by [NPR's Planet Money](http://www.npr.org/sections/money/2015/02/05/382664837/map-the-most-common-job-in-every-state) <a href="#footnote-1">[1]</a> on census data of the same time period we see that the most common job in most states is truck driver. This type of employment may be made obsolete as more and more individuals become comfortable with driver-less vehicles. Unfortunately, changes and comfort with driver-less cars will inevitably lead to driver-less trucks.  

<center>
![*Map: The Most Common\* Job In Every State - NPR*](https://raw.githubusercontent.com/ChristopheHunt/MSDA---Coursework/master/Data%20608/Final%20Project/NPR%20Most%20Common%20Jobs.PNG)
</center>

<br>

## Regional Differences 

It would seem that perhaps we will see regional differences in views of certain technologies and the employment types. For instance, in the census region `South` nearly every state has the greatest occupation as Truck Driver except for Florida which has Primary School Teacher. Let's see the ratio of positive views to negative views for this question by region. 

```{r, message=FALSE, warning=FALSE, echo=FALSE, cache=TRUE, include = FALSE}
require(maptools)
require(rgdal)
state_shape_files <- "http://www2.census.gov/geo/tiger/GENZ2015/shp/cb_2015_us_region_500k.zip"
download.file(state_shape_files, destfile = "cb_2015_us_region_500k.zip")
unzip("cb_2015_us_region_500k.zip")
regions <- readOGR(dsn = ".", layer = "cb_2015_us_region_500k")

regions@data$id <- rownames(regions@data)

region.df <- fortify(regions, region = "id") %>% 
             plyr::join(regions@data, by = "id") 
#%>%             merge(business_data, by.x = c("STUSPS"), by.y = c("State"))

file.remove(dir(getwd(), pattern = "cb_2015_us_region_500k", full.names = TRUE)) #Clean Up 

region.df <- region.df[!(region.df$long >0),] 

regions.names <- fortify(aggregate(cbind(long, lat) ~ id + NAME, data = region.df, FUN = mean)) 
```

<center>

```{r, message=FALSE, warning=FALSE, echo=FALSE, cache=TRUE, fig.height=6, fig.width=8}
drv.less.car <- survey.data %>% 
                 dplyr::select(cregion, pial4b, weight) %>%
                 mutate(weight = as.numeric(weight)) %>%
                 group_by(cregion) %>%
                 mutate(Yes = (1 * weight)) %>%
                 select(-weight)

drv.less.car$row <- 1:nrow(drv.less.car)

drv.less.car <- drv.less.car %>%
                spread(pial4b, Yes, fill = 0) %>%
                select(-row) %>%
                summarise_each(funs(sum)) %>%
                mutate(TotalSurved.weighted = rowSums(.[2:5]))

drv.less.car[,-1] <- round(drv.less.car[,-1],0)

drv.less.car <- drv.less.car %>%
                mutate(Ratio.YestoNo = `Yes, would do this`/`No, would not do this`) %>%
                select(cregion, Ratio.YestoNo)

region.df.drvlesscar <-  merge(x = region.df, y = drv.less.car,  "NAME", by.y = "cregion")

ggplot(region.df.drvlesscar) + 
  geom_polygon(colour="grey40", aes(long, lat, group = group, fill = Ratio.YestoNo) ) +
  geom_text(data = regions.names, aes(long, lat, label = NAME), size=3, colour = "firebrick3", fontface = "bold") + 
  theme_void() +
  scale_fill_gradientn(colors = brewer.pal(9,"PuBu"), space = "Lab", guide = "legend") +
  ggtitle(paste0("\n\nRatio of people would ride in a driverless car to those that would not by US Census Regions"))
```
</center>

Employment Data Source: U.S. Census Bureau, 2010-2014 American Community Survey 5-Year Estimates 

Technology Views Data Source:  Pew Research Center, April, 2014, "U.S. Views of Technology and the Future" Available at:
http://www.pewinternet.org/2014/04/17/us-views-of-technology-and-the-future/ 

Note: *The Pew Research Center bears no responsibility for the interpretations presented or conclusions reached based on analysis of the data.*

<p id="footnote-1">[1] "Map: The Most Common* Job In Every State." NPR. NPR, n.d. Web. 03 Dec. 2016.</p>



