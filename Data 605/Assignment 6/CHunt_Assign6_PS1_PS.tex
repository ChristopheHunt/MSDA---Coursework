\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={Homework 6},
            pdfauthor={Christophe Hunt},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{{#1}}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{{#1}}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\ImportTok}[1]{{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{{#1}}}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{{#1}}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{{#1}}}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{{#1}}}}
\newcommand{\BuiltInTok}[1]{{#1}}
\newcommand{\ExtensionTok}[1]{{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{{#1}}}
\newcommand{\RegionMarkerTok}[1]{{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{{#1}}}}
\newcommand{\NormalTok}[1]{{#1}}
\usepackage{longtable,booktabs}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\newcommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}
  \title{Homework 6}
  \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
  \author{Christophe Hunt}
  \preauthor{\centering\large\emph}
  \postauthor{\par}
  \predate{\centering\large\emph}
  \postdate{\par}
  \date{March 12, 2017}

\usepackage{relsize}
\usepackage{setspace}
\usepackage{amsmath,amsfonts,amsthm}
\usepackage[sfdefault]{roboto}
\usepackage[T1]{fontenc}
\usepackage{float}
\usepackage{multirow}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{2}
\tableofcontents
}
\section{Problem Set 1}\label{problem-set-1}

\subsection{(1) When you roll a fair die 3 times, how many possible
outcomes are
there?}\label{when-you-roll-a-fair-die-3-times-how-many-possible-outcomes-are-there}

\begin{quote}
Sample space of a die = (1, 2, 3, 4, 5, 6)
\end{quote}

\begin{quote}
Number of outcomes = \(6^3\) or 216
\end{quote}

\subsection{(2) What is the probability of getting a sum total of 3 when
you roll a die two
times?}\label{what-is-the-probability-of-getting-a-sum-total-of-3-when-you-roll-a-die-two-times}

\begin{quote}
Sample space of a die = (1, 2, 3, 4, 5, 6)
\end{quote}

\begin{quote}
Possible combinations equal to 3 when \(die_1\) is rolled twice = (1,2),
(2,1).
\end{quote}

\begin{quote}
There are two (2) possible combinations out of a total of \(6^2\) or 36
combinations.
\end{quote}

\begin{quote}
Therefore, the probability is\\
\(\frac{2}{36}\) = 5.56\%
\end{quote}

\subsection{(3) Birthday problems}\label{birthday-problems}

Assume a room of 25 strangers. What is the probability that two of them
have the same birthday?

\begin{quote}
We begin by calculating the probability that someone has a birthday that
is not shared with another person. (e.g.~the second person has a
probability of 364 out of 365 of not sharing a birthday with another
individual). Then we subtract that probability from one to arrive at the
probability that a number of people share a birthday.
\end{quote}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{prob_birth <-}\StringTok{ }\NormalTok{(}\DecValTok{0}\NormalTok{:}\DecValTok{24}\NormalTok{)}
\NormalTok{prob_birth <-}\StringTok{ }\DecValTok{365} \NormalTok{-}\StringTok{ }\NormalTok{prob_birth}
\NormalTok{prob_birth <-}\StringTok{ }\NormalTok{prob_birth/}\DecValTok{365}
\KeywordTok{paste0}\NormalTok{(}\StringTok{"The probability that two people do not share a birthday out of "}\NormalTok{, }
       \KeywordTok{length}\NormalTok{(prob_birth), }\StringTok{" is "}\NormalTok{, }\KeywordTok{percent}\NormalTok{(}\KeywordTok{prod}\NormalTok{(prob_birth)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "The probability that two people do not share a birthday out of 25 is 43.1%"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{paste0}\NormalTok{(}\StringTok{"The probability that two people do share a birthday out of "}\NormalTok{, }
       \KeywordTok{length}\NormalTok{(prob_birth), }\StringTok{" is "}\NormalTok{, }\KeywordTok{percent}\NormalTok{(}\DecValTok{1} \NormalTok{-}\StringTok{ }\KeywordTok{prod}\NormalTok{(prob_birth)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "The probability that two people do share a birthday out of 25 is 56.9%"
\end{verbatim}

Assume that all birthdays are equally likely and equal to 1/365 each.
What happens to this probability when there are 50 people in the room?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{prob_birth <-}\StringTok{ }\NormalTok{(}\DecValTok{0}\NormalTok{:}\DecValTok{49}\NormalTok{)}
\NormalTok{prob_birth <-}\StringTok{ }\DecValTok{365} \NormalTok{-}\StringTok{ }\NormalTok{prob_birth}
\NormalTok{prob_birth <-}\StringTok{ }\NormalTok{prob_birth/}\DecValTok{365}
\KeywordTok{paste0}\NormalTok{(}\StringTok{"The probability that two people do not share a birthday out of "}\NormalTok{, }
       \KeywordTok{length}\NormalTok{(prob_birth), }\StringTok{" is "}\NormalTok{, }\KeywordTok{percent}\NormalTok{(}\KeywordTok{prod}\NormalTok{(prob_birth)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "The probability that two people do not share a birthday out of 50 is 2.96%"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{paste0}\NormalTok{(}\StringTok{"The probability that two people do share a birthday out of "}\NormalTok{, }
       \KeywordTok{length}\NormalTok{(prob_birth), }\StringTok{" is "}\NormalTok{, }\KeywordTok{percent}\NormalTok{(}\DecValTok{1} \NormalTok{-}\StringTok{ }\KeywordTok{prod}\NormalTok{(prob_birth)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "The probability that two people do share a birthday out of 50 is 97%"
\end{verbatim}

\newpage

\section{Problem Set 2}\label{problem-set-2}

Sometimes you cannot compute the probability of an outcome by measuring
the sample space and examining the symmetries of the underlying physical
phenomenon, as you could do when you rolled die or picked a card from a
shuffled deck. You have to estimate probabilities by other means.

For instance, when you have to compute the probability of various
english words, it is not possible to do it by examination of the sample
space as it is too large. You have to resort to empirical techniques to
get a good enough estimate. One such approach would be to take a large
corpus of documents and from those documents, count the number of
occurrences of a particular character or word and then base your
estimate on that.

Write a program to take a document in English and print out the
estimated probabilities for each of the words that occur in that
document. Your program should take in a file containing a large document
and write out the probabilities of each of the words that appear in that
document. Please remove all punctuation (quotes, commas, hyphens etc)
and convert the words to lower case before you perform your
calculations.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(tm)}
\KeywordTok{library}\NormalTok{(dplyr)}
\KeywordTok{library}\NormalTok{(knitr)}
\KeywordTok{library}\NormalTok{(RTextTools)}
\KeywordTok{library}\NormalTok{(ggplot2)}
\KeywordTok{library}\NormalTok{(scales)}
\KeywordTok{library}\NormalTok{(DT)}
\KeywordTok{library}\NormalTok{(stringr)}
\KeywordTok{library}\NormalTok{(data.table)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{doc <-}\StringTok{ }\KeywordTok{readLines}\NormalTok{(}\StringTok{"https://raw.githubusercontent.com/ChristopheHunt/MSDA---Coursework/master/Data%20605/Assignment%206/text%20document.txt"}\NormalTok{)}

\NormalTok{doc <-}\StringTok{ }\KeywordTok{Corpus}\NormalTok{(}\KeywordTok{VectorSource}\NormalTok{(doc))}

\NormalTok{clean_doc <-}\StringTok{  }\NormalTok{doc                                       %>%}
\StringTok{              }\KeywordTok{tm_map}\NormalTok{(}\KeywordTok{content_transformer}\NormalTok{(tolower))      %>%}
\StringTok{              }\KeywordTok{tm_map}\NormalTok{(removeNumbers)                     %>%}
\StringTok{              }\KeywordTok{tm_map}\NormalTok{(removeWords, }\KeywordTok{stopwords}\NormalTok{(}\StringTok{"english"}\NormalTok{)) %>%}
\StringTok{              }\KeywordTok{tm_map}\NormalTok{(removePunctuation)                 %>%}
\StringTok{              }\CommentTok{#tm_map(stemDocument)                      %>%}
\StringTok{              }\KeywordTok{DocumentTermMatrix}\NormalTok{()}


\NormalTok{##the entire document is too large so subsetting the matrix}
\NormalTok{freq <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{colSums}\NormalTok{(}\KeywordTok{as.matrix}\NormalTok{(clean_doc[}\DecValTok{1}\NormalTok{:}\DecValTok{20000}\NormalTok{,])))}
\NormalTok{freq <-}\StringTok{ }\KeywordTok{setDT}\NormalTok{(freq, }\DataTypeTok{keep.rownames =} \OtherTok{TRUE}\NormalTok{)[]}
\KeywordTok{colnames}\NormalTok{(freq) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"word_type"}\NormalTok{, }\StringTok{"prob_appearance"}\NormalTok{)}
\NormalTok{freq$prob_appearance <-}\StringTok{ }\KeywordTok{percent}\NormalTok{(freq$prob_appearance/}\KeywordTok{sum}\NormalTok{(freq$prob_appearance))}

\KeywordTok{kable}\NormalTok{(}\KeywordTok{head}\NormalTok{(}\KeywordTok{arrange}\NormalTok{(freq,}\KeywordTok{desc}\NormalTok{(prob_appearance)), }\DataTypeTok{n =} \DecValTok{10}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}ll@{}}
\toprule
word\_type & prob\_appearance\tabularnewline
\midrule
\endhead
upon & 0.609\%\tabularnewline
one & 0.542\%\tabularnewline
new & 0.507\%\tabularnewline
said & 0.466\%\tabularnewline
states & 0.462\%\tabularnewline
holmes & 0.399\%\tabularnewline
american & 0.363\%\tabularnewline
man & 0.317\%\tabularnewline
will & 0.317\%\tabularnewline
government & 0.305\%\tabularnewline
\bottomrule
\end{longtable}

Extend your program to calculate the probability of two words occurring
adjacent to each other. It should take in a document, and two words (say
the and for) and compute the probability of each of the words occurring
in the document and the joint probability of both of them occurring
together. The order of the two words is not important.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(tm)}
\KeywordTok{library}\NormalTok{(dplyr)}
\KeywordTok{library}\NormalTok{(knitr)}
\KeywordTok{library}\NormalTok{(RTextTools)}
\KeywordTok{library}\NormalTok{(ggplot2)}
\KeywordTok{library}\NormalTok{(scales)}
\KeywordTok{library}\NormalTok{(DT)}
\KeywordTok{library}\NormalTok{(stringr)}
\KeywordTok{library}\NormalTok{(data.table)}
\KeywordTok{library}\NormalTok{(lda)}

\NormalTok{doc <-}\StringTok{ }\KeywordTok{Corpus}\NormalTok{(}\KeywordTok{VectorSource}\NormalTok{(doc))}

\NormalTok{clean_doc <-}\StringTok{  }\NormalTok{doc                                       %>%}
\StringTok{              }\KeywordTok{tm_map}\NormalTok{(}\KeywordTok{content_transformer}\NormalTok{(tolower))      %>%}
\StringTok{              }\KeywordTok{tm_map}\NormalTok{(removeNumbers)                     %>%}
\StringTok{              }\KeywordTok{tm_map}\NormalTok{(removeWords, }\KeywordTok{stopwords}\NormalTok{(}\StringTok{"english"}\NormalTok{)) %>%}
\StringTok{              }\KeywordTok{tm_map}\NormalTok{(removePunctuation)                 %>%}
\StringTok{              }\KeywordTok{tm_map}\NormalTok{(stemDocument)                      %>%}
\StringTok{              }\KeywordTok{DocumentTermMatrix}\NormalTok{()}


\NormalTok{##the entire document is too large so subsetting the matrix}
\NormalTok{freq <-}\StringTok{ }\KeywordTok{colSums}\NormalTok{(}\KeywordTok{as.matrix}\NormalTok{(clean_doc[}\DecValTok{1}\NormalTok{:}\DecValTok{10000}\NormalTok{,]))}
\NormalTok{freq <-}\StringTok{ }\NormalTok{freq/}\KeywordTok{length}\NormalTok{(freq)}
\end{Highlighting}
\end{Shaded}

Use the accompanying document for your testing purposes. Compare your
probabilities of various words with the Time Magazine corpus:
\url{http://corpus.byu.edu/time/}


\end{document}
