\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={Homework 4},
            pdfauthor={Christophe Hunt},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{{#1}}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{{#1}}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\ImportTok}[1]{{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{{#1}}}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{{#1}}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{{#1}}}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{{#1}}}}
\newcommand{\BuiltInTok}[1]{{#1}}
\newcommand{\ExtensionTok}[1]{{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{{#1}}}
\newcommand{\RegionMarkerTok}[1]{{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{{#1}}}}
\newcommand{\NormalTok}[1]{{#1}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\newcommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}
  \title{Homework 4}
  \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
  \author{Christophe Hunt}
  \preauthor{\centering\large\emph}
  \postauthor{\par}
  \predate{\centering\large\emph}
  \postdate{\par}
  \date{February 20, 2017}

\usepackage{relsize}
\usepackage{setspace}
\usepackage{amsmath,amsfonts,amsthm}
\usepackage[sfdefault]{roboto}
\usepackage[T1]{fontenc}
\usepackage{float}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{2}
\tableofcontents
}
\section{Problem Set 1}\label{problem-set-1}

In this problem, we'll verify using R that SVD and Eigenvalues are
related as worked out in the weekly module. Given a 3 Ã— 2 matrix A

\[
A = \begin{bmatrix}
    1 & 2 & 3 \\
   -1 & 0 & 4 
\end{bmatrix}
\]

\subsection{write code in R to compute X = AAT and Y =
ATA.}\label{write-code-in-r-to-compute-x-aat-and-y-ata.}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{A <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,-}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{), }\DataTypeTok{nrow=}\DecValTok{2}\NormalTok{)}
\NormalTok{X <-}\StringTok{ }\NormalTok{A%*%}\KeywordTok{t}\NormalTok{(A)}
\NormalTok{Y <-}\StringTok{ }\KeywordTok{t}\NormalTok{(A)%*%A}
\KeywordTok{list}\NormalTok{(}\StringTok{"X"} \NormalTok{=}\StringTok{ }\NormalTok{X, }\StringTok{"Y"} \NormalTok{=}\StringTok{ }\NormalTok{Y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $X
##      [,1] [,2]
## [1,]   14   11
## [2,]   11   17
## 
## $Y
##      [,1] [,2] [,3]
## [1,]    2    2   -1
## [2,]    2    4    6
## [3,]   -1    6   25
\end{verbatim}

\newpage

\subsection{Then, compute the eigenvalues and eigenvectors of X and Y
using the built-in commads in
R.}\label{then-compute-the-eigenvalues-and-eigenvectors-of-x-and-y-using-the-built-in-commads-in-r.}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{results <-}\StringTok{ }\KeywordTok{list}\NormalTok{(}\StringTok{"X"} \NormalTok{=}\StringTok{ }\KeywordTok{eigen}\NormalTok{(X))}
\NormalTok{results <-}\StringTok{ }\KeywordTok{c}\NormalTok{(results, }\StringTok{"Y"} \NormalTok{=}\StringTok{ }\KeywordTok{eigen}\NormalTok{(Y))}
\NormalTok{results}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $X
## $X$values
## [1] 26.601802  4.398198
## 
## $X$vectors
##           [,1]       [,2]
## [1,] 0.6576043 -0.7533635
## [2,] 0.7533635  0.6576043
## 
## 
## $Y.values
## [1] 2.660180e+01 4.398198e+00 1.058982e-16
## 
## $Y.vectors
##             [,1]       [,2]       [,3]
## [1,] -0.01856629 -0.6727903  0.7396003
## [2,]  0.25499937 -0.7184510 -0.6471502
## [3,]  0.96676296  0.1765824  0.1849001
\end{verbatim}

\subsection{Then, compute the left-singular, singular values, and
right-singular vectors of A using the svd
command.}\label{then-compute-the-left-singular-singular-values-and-right-singular-vectors-of-a-using-the-svd-command.}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{results <-}\StringTok{ }\KeywordTok{svd}\NormalTok{(A)}
\KeywordTok{names}\NormalTok{(results) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"singular"}\NormalTok{, }\StringTok{"left-singular"}\NormalTok{, }\StringTok{"right-singular"}\NormalTok{)}
\NormalTok{results}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $singular
## [1] 5.157693 2.097188
## 
## $`left-singular`
##            [,1]       [,2]
## [1,] -0.6576043 -0.7533635
## [2,] -0.7533635  0.6576043
## 
## $`right-singular`
##             [,1]       [,2]
## [1,]  0.01856629 -0.6727903
## [2,] -0.25499937 -0.7184510
## [3,] -0.96676296  0.1765824
\end{verbatim}

\subsection{Examine the two sets of singular vectors and show that they
are indeed eigenvectors of X and
Y.}\label{examine-the-two-sets-of-singular-vectors-and-show-that-they-are-indeed-eigenvectors-of-x-and-y.}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{results$}\StringTok{`}\DataTypeTok{left-singular}\StringTok{`}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            [,1]       [,2]
## [1,] -0.6576043 -0.7533635
## [2,] -0.7533635  0.6576043
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{X_vectors <-}\StringTok{ }\KeywordTok{eigen}\NormalTok{(X)$vectors}
\NormalTok{X_vectors}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##           [,1]       [,2]
## [1,] 0.6576043 -0.7533635
## [2,] 0.7533635  0.6576043
\end{verbatim}

We can see that the two sets of vectors are indeed eigenvectors of X and
Y. Also, note that the sign switch does not impact the interpetation of
the eigenvectors, we can multiply by -1 and it has no further impact.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{results$}\StringTok{`}\DataTypeTok{left-singular}\StringTok{`}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            [,1]       [,2]
## [1,] -0.6576043 -0.7533635
## [2,] -0.7533635  0.6576043
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{X_vectors[,}\DecValTok{1}\NormalTok{] <-}\StringTok{ }\NormalTok{(X_vectors[,}\DecValTok{1}\NormalTok{]*-}\DecValTok{1}\NormalTok{)}
\NormalTok{X_vectors}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            [,1]       [,2]
## [1,] -0.6576043 -0.7533635
## [2,] -0.7533635  0.6576043
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{results$}\StringTok{`}\DataTypeTok{right-singular}\StringTok{`}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##             [,1]       [,2]
## [1,]  0.01856629 -0.6727903
## [2,] -0.25499937 -0.7184510
## [3,] -0.96676296  0.1765824
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Y_vectors <-}\StringTok{ }\KeywordTok{eigen}\NormalTok{(Y)$vectors}
\NormalTok{Y_vectors[,}\DecValTok{1}\NormalTok{] <-}\StringTok{ }\NormalTok{(Y_vectors[,}\DecValTok{1}\NormalTok{]*-}\DecValTok{1}\NormalTok{)}
\NormalTok{Y_vectors}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##             [,1]       [,2]       [,3]
## [1,]  0.01856629 -0.6727903  0.7396003
## [2,] -0.25499937 -0.7184510 -0.6471502
## [3,] -0.96676296  0.1765824  0.1849001
\end{verbatim}

\section{2. Problem Set 2}\label{problem-set-2}

Using the procedure outlined in section 1 of the weekly handout, write a
function to compute the inverse of a well-conditioned full-rank square
matrix using co-factors. In order to compute the co-factors, you may use
built-in commands to compute the determinant. Your function should have
the following signature:

B = myinverse(A)

where A is a matrix and B is its inverse and AÃ—B = I. The off-diagonal
elements of I should be close to zero, if not zero. Likewise, the
diagonal elements should be close to 1, if not 1. Small numerical
precision errors are acceptable but the function myinverse should be
correct and must use co-factors and determinant of A to compute the
inverse.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{myinverse <-}\StringTok{ }\NormalTok{function(M)\{}
              \NormalTok{results <-}\StringTok{ }\KeywordTok{list}\NormalTok{()}
              \NormalTok{results$original <-}\StringTok{ }\NormalTok{M }
              \CommentTok{#save original to compare}
              \NormalTok{cofactors <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{nrow =} \KeywordTok{nrow}\NormalTok{(M), }\DataTypeTok{ncol =} \KeywordTok{ncol}\NormalTok{(M)) }
              \CommentTok{# create empty matrix to store cofactors}
              \NormalTok{for(i in }\DecValTok{1}\NormalTok{:}\KeywordTok{nrow}\NormalTok{(M))\{ }\CommentTok{#loop over rows}
                \NormalTok{for (j in }\DecValTok{1}\NormalTok{:}\KeywordTok{ncol}\NormalTok{(M)) }\CommentTok{# loop over columns}
                  \NormalTok{cofactors[i,j] <-}\StringTok{ }\NormalTok{((-}\DecValTok{1}\NormalTok{)^(i +}\StringTok{ }\NormalTok{j)*}\KeywordTok{det}\NormalTok{(M[-i, -j])) }
                \CommentTok{#for row, column; sign * determinate of submatrix}
              \NormalTok{\}}
              \NormalTok{results$inverse <-}\StringTok{ }\KeywordTok{t}\NormalTok{(cofactors)/}\KeywordTok{det}\NormalTok{(M) }
              \CommentTok{#transpose of cofactors matrix / determinate of original matrix}
              \KeywordTok{return}\NormalTok{(results)}
            \NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{M <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{:}\DecValTok{7}\NormalTok{,}\DecValTok{12}\NormalTok{,}\DecValTok{20}\NormalTok{), }\DataTypeTok{nrow =} \DecValTok{3}\NormalTok{)}
\KeywordTok{myinverse}\NormalTok{(M)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $original
##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5   12
## [3,]    3    6   20
## 
## $inverse
##            [,1]       [,2]       [,3]
## [1,] -3.1111111  4.2222222 -1.4444444
## [2,]  0.4444444  0.1111111 -0.2222222
## [3,]  0.3333333 -0.6666667  0.3333333
\end{verbatim}


\end{document}
